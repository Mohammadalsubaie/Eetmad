# Ù…Ø«Ø§Ù„ Ù„Ø¯Ù…Ø¬ Ø³ÙƒØ±ÙŠØ¨Øª ÙØ­Øµ Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø¨Ù†Ø§Ø¡ Ù…Ø¹ CI/CD
# ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‡Ø°Ø§ Ù…Ø¹ GitHub Actions, GitLab CI, Ø£Ùˆ Ø£ÙŠ Ù†Ø¸Ø§Ù… CI/CD Ø¢Ø®Ø±

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# GitHub Actions Example
# Ù…Ù„Ù: .github/workflows/validate-design.yml
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

name: Validate Design Rules

on:
  pull_request:
    paths:
      - 'frontend/eetmad/src/**/*.tsx'
      - 'frontend/eetmad/src/**/*.ts'
  push:
    branches:
      - main
      - develop

jobs:
  validate-design:
    name: Validate Design Rules
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v3
        with:
          fetch-depth: 0

      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'
          cache: 'npm'
          cache-dependency-path: frontend/eetmad/package-lock.json

      - name: Install dependencies
        working-directory: frontend/eetmad
        run: npm ci

      - name: Run Design Rules Validation
        working-directory: frontend/eetmad
        run: |
          npm run validate:design src/ -- --json validation-report.json

      - name: Upload validation report
        if: always()
        uses: actions/upload-artifact@v3
        with:
          name: design-validation-report
          path: frontend/eetmad/validation-report.json

      - name: Comment PR with results
        if: github.event_name == 'pull_request' && failure()
        uses: actions/github-script@v6
        with:
          script: |
            const fs = require('fs');
            const report = JSON.parse(fs.readFileSync('frontend/eetmad/validation-report.json', 'utf8'));
            
            const comment = `
            ## ğŸ¨ Design Rules Validation Report
            
            **Summary:**
            - ğŸ“ Files scanned: ${report.summary.totalFiles}
            - âŒ Total errors: ${report.summary.totalErrors}
            - âš ï¸ Total warnings: ${report.summary.totalWarnings}
            
            ${report.summary.totalErrors > 0 ? 'âŒ **Validation failed!** Please fix the errors above.' : 'âœ… All files follow design rules!'}
            
            <details>
            <summary>View detailed report</summary>
            
            \`\`\`json
            ${JSON.stringify(report, null, 2)}
            \`\`\`
            
            </details>
            
            ğŸ“– See [Component Building Guidelines](../blob/main/frontend/eetmad/docs/design/component-building-guidelines.md) for more details.
            `;
            
            github.rest.issues.createComment({
              issue_number: context.issue.number,
              owner: context.repo.owner,
              repo: context.repo.repo,
              body: comment
            });

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# GitLab CI Example
# Ù…Ù„Ù: .gitlab-ci.yml
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

validate-design:
  stage: test
  image: node:18
  script:
    - cd frontend/eetmad
    - npm ci
    - npm run validate:design src/ -- --json validation-report.json
  artifacts:
    when: always
    paths:
      - frontend/eetmad/validation-report.json
    reports:
      junit: frontend/eetmad/validation-report.json
  only:
    changes:
      - frontend/eetmad/src/**/*.tsx
      - frontend/eetmad/src/**/*.ts

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Jenkins Pipeline Example
# Ù…Ù„Ù: Jenkinsfile
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

pipeline {
  agent any
  
  stages {
    stage('Setup') {
      steps {
        dir('frontend/eetmad') {
          sh 'npm ci'
        }
      }
    }
    
    stage('Validate Design Rules') {
      steps {
        dir('frontend/eetmad') {
          sh 'npm run validate:design src/ -- --json validation-report.json'
        }
      }
      post {
        always {
          archiveArtifacts artifacts: 'frontend/eetmad/validation-report.json', fingerprint: true
        }
      }
    }
  }
}

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Azure Pipelines Example
# Ù…Ù„Ù: azure-pipelines.yml
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

trigger:
  branches:
    include:
      - main
      - develop
  paths:
    include:
      - frontend/eetmad/src/**/*.tsx
      - frontend/eetmad/src/**/*.ts

pool:
  vmImage: 'ubuntu-latest'

steps:
  - task: NodeTool@0
    inputs:
      versionSpec: '18.x'
    displayName: 'Install Node.js'

  - script: |
      cd frontend/eetmad
      npm ci
    displayName: 'Install dependencies'

  - script: |
      cd frontend/eetmad
      npm run validate:design src/ -- --json validation-report.json
    displayName: 'Validate Design Rules'

  - task: PublishBuildArtifacts@1
    condition: always()
    inputs:
      pathToPublish: 'frontend/eetmad/validation-report.json'
      artifactName: 'design-validation-report'
    displayName: 'Publish validation report'

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# CircleCI Example
# Ù…Ù„Ù: .circleci/config.yml
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

version: 2.1

jobs:
  validate-design:
    docker:
      - image: cimg/node:18.0
    steps:
      - checkout
      - restore_cache:
          keys:
            - v1-dependencies-{{ checksum "frontend/eetmad/package-lock.json" }}
            - v1-dependencies-
      - run:
          name: Install dependencies
          command: |
            cd frontend/eetmad
            npm ci
      - save_cache:
          paths:
            - frontend/eetmad/node_modules
          key: v1-dependencies-{{ checksum "frontend/eetmad/package-lock.json" }}
      - run:
          name: Validate Design Rules
          command: |
            cd frontend/eetmad
            npm run validate:design src/ -- --json validation-report.json
      - store_artifacts:
          path: frontend/eetmad/validation-report.json
          destination: design-validation-report

workflows:
  version: 2
  validate:
    jobs:
      - validate-design:
          filters:
            branches:
              only:
                - main
                - develop

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Pre-commit Hook Example
# Ù…Ù„Ù: .husky/pre-commit
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "ğŸ” Running design rules validation on staged files..."

# Get staged TypeScript/TSX files
STAGED_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep -E '^frontend/eetmad/src/.*\.(tsx|ts)$')

if [ -z "$STAGED_FILES" ]; then
  echo "âœ… No TypeScript files to validate"
  exit 0
fi

# Change to frontend directory
cd frontend/eetmad

# Run validation on staged files
npm run validate:design $STAGED_FILES

VALIDATION_EXIT_CODE=$?

if [ $VALIDATION_EXIT_CODE -ne 0 ]; then
  echo ""
  echo "âŒ Design rules validation failed!"
  echo "   Please fix the errors above before committing."
  echo ""
  echo "ğŸ’¡ Tips:"
  echo "   - Check frontend/eetmad/docs/design/component-building-guidelines.md"
  echo "   - Use cssVars from @/styles/theme for all colors"
  echo "   - Use useTranslations from next-intl for all text"
  echo ""
  echo "   To bypass this check (not recommended):"
  echo "   git commit --no-verify"
  echo ""
  exit 1
fi

echo "âœ… Design rules validation passed!"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Pre-push Hook Example
# Ù…Ù„Ù: .husky/pre-push
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "ğŸ” Running full design rules validation before push..."

cd frontend/eetmad

# Run full validation on src directory
npm run validate:design src/

VALIDATION_EXIT_CODE=$?

if [ $VALIDATION_EXIT_CODE -ne 0 ]; then
  echo ""
  echo "âŒ Design rules validation failed!"
  echo "   Cannot push with design rule violations."
  echo ""
  echo "   To bypass this check (not recommended):"
  echo "   git push --no-verify"
  echo ""
  exit 1
fi

echo "âœ… All design rules validation passed!"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Package.json Scripts Example
# Ù…Ù„Ù: frontend/eetmad/package.json
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ø¥Ø¶Ø§ÙØ© scripts Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ù„ØªÙƒØ§Ù…Ù„

{
  "scripts": {
    "validate:design": "tsx scripts/validate-design-rules.ts",
    "validate:design:src": "npm run validate:design src/",
    "validate:design:components": "npm run validate:design src/components/",
    "validate:design:features": "npm run validate:design src/components/features/",
    "validate:design:ci": "npm run validate:design src/ -- --json ci-report.json",
    "precommit": "npm run validate:design $(git diff --cached --name-only --diff-filter=ACM | grep -E '\\.(tsx|ts)$')",
    "prepush": "npm run validate:design:src"
  }
}

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# VS Code Tasks Example
# Ù…Ù„Ù: .vscode/tasks.json
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "Validate Design Rules (Current File)",
      "type": "shell",
      "command": "cd frontend/eetmad && npm run validate:design ${file}",
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "new"
      },
      "group": {
        "kind": "test",
        "isDefault": true
      }
    },
    {
      "label": "Validate Design Rules (All Files)",
      "type": "shell",
      "command": "cd frontend/eetmad && npm run validate:design src/",
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "new"
      }
    },
    {
      "label": "Validate Design Rules (Components)",
      "type": "shell",
      "command": "cd frontend/eetmad && npm run validate:design src/components/",
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "new"
      }
    }
  ]
}

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Docker Integration Example
# Ù…Ù„Ù: Dockerfile.ci
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

FROM node:18-alpine

WORKDIR /app

# Copy package files
COPY frontend/eetmad/package*.json ./

# Install dependencies
RUN npm ci

# Copy source files
COPY frontend/eetmad/ ./

# Run validation
CMD ["npm", "run", "validate:design", "src/", "--", "--json", "validation-report.json"]

# Build: docker build -f Dockerfile.ci -t design-validator .
# Run: docker run -v $(pwd)/reports:/app/validation-report.json design-validator

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Make Integration Example
# Ù…Ù„Ù: Makefile
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

.PHONY: validate-design validate-design-src validate-design-components

validate-design:
	cd frontend/eetmad && npm run validate:design $(path)

validate-design-src:
	cd frontend/eetmad && npm run validate:design src/

validate-design-components:
	cd frontend/eetmad && npm run validate:design src/components/

validate-design-ci:
	cd frontend/eetmad && npm run validate:design src/ -- --json ci-report.json

# Ø§Ø³ØªØ®Ø¯Ø§Ù…:
# make validate-design path=src/components/features/home/
# make validate-design-src
# make validate-design-ci

